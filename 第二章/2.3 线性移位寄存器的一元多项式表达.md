
## 一、通俗入门：什么是 LFSR？为什么和多项式有关？

### 📦 类比：LFSR 就像“密码学版的滑动窗口”

想象你有一个固定长度的窗口（比如 4 个格子），里面每个格子可以放 0 或 1。

每次：

1. 你从当前窗口状态里，按照一定规则计算一个新的比特（称为反馈位）
    
2. 把窗口整体右移一位，把新的比特加到最左边
    
3. 最右边的比特就是你“输出的密钥流位”
    

这个结构就叫做 **线性反馈移位寄存器（LFSR）**。

---

### 🔁 举个例子（4位LFSR）：

假设我们有 4 个寄存器 `[a₃, a₂, a₁, a₀]`  
反馈位规则为：`new = a₃ ⊕ a₀`（即第 4 位和第 1 位异或）

如果初始状态是 `[1, 0, 0, 1]`，下一轮就是：

- new = `1 ⊕ 1 = 0`
    
- 新状态：`[0, 1, 0, 0]`
    

继续滑动生成比特流...

---

## 二、为什么要用“多项式”表示它？

因为我们想要对 LFSR 的行为做**数学分析**，比如周期性、是否有重复、是否能预测输出。最好的方式就是用“代数模型”来描述它。

> 多项式是描述移位和反馈的自然语言！

---

## 三、一元多项式表示 LFSR 的方式

设你有一个长度为 n 的 LFSR，反馈规则如下：

> `aₙ = c₁aₙ₋₁ ⊕ c₂aₙ₋₂ ⊕ ... ⊕ cₙa₀`  
> 其中每个 `cᵢ ∈ {0,1}` 是反馈系数

我们用一个多项式来表示这些系数：

### 📘 定义：**连接多项式（Connection Polynomial）**

> `C(x) = 1 + c₁x + c₂x² + ... + cₙxⁿ`

注意第一个系数固定为 1，这是标准约定。

---

### ✅ 举例：

如果我们有一个 4 位 LFSR，规则是：

> `a₄ = a₃ ⊕ a₀`  
> 则连接多项式为：

> `C(x) = 1 + x + x⁴`

（因为 feedback 来自 a₃ 和 a₀）

---

## 四、重要定理和性质

---

### **定理 1：LFSR 输出序列是线性递推序列**

> 任意一个 LFSR 所生成的比特序列，都满足一个线性递推关系：

> `aₙ = c₁aₙ₋₁ + c₂aₙ₋₂ + ... + cₙa₀` over GF(2)

这意味着它是一个**线性序列**，并且可以用矩阵、线性代数等方法来刻画。

---

### **定理 2：连接多项式决定了 LFSR 的周期**

假设连接多项式 `C(x)` 是**不可约的**（在 GF(2) 上不能因式分解），并且它是一个**本原多项式（primitive polynomial）**，那么：

> LFSR 的周期将达到最大值：`2ⁿ - 1`

这是最理想的情况，称为“**最大周期 LFSR**”。

---

### ✅ 例子：4 位本原多项式

> `C(x) = 1 + x + x⁴`

这个多项式在 GF(2) 上是本原的，对应的 LFSR 有最大周期：

> `2⁴ - 1 = 15`

这意味着只要初始状态不为全零，它就会输出一段长度为 15 的密钥流，然后才重复。

---

### **定理 3：LFSR 输出序列的生成函数是有理函数**

设输出序列为 `{a₀, a₁, a₂, ...}`，则它对应的**生成函数**

> `A(x) = a₀ + a₁x + a₂x² + ...`

是一个**有理函数**，即可以表示为：

> `A(x) = P(x) / C(x)`，其中 P(x) 是某个多项式，C(x) 是连接多项式

这个结构让我们可以用代数方法分析输出序列的性质。

---

### **性质：线性复杂度 = 最短连接多项式的阶数**

线性复杂度衡量的是你最少需要多少长度的 LFSR 才能生成一个给定的序列。

- 如果一个序列可以用一个 5 位 LFSR 生成，那它的线性复杂度就是 5
    
- 越高越安全，越低越容易被预测
    

