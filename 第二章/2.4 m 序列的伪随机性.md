## 一、通俗理解：什么是 m 序列？为什么它“伪随机”？

---

m序列（maximum-length sequence，最大长度序列）是由一个**最大周期的 LFSR（线性反馈移位寄存器）**生成的二进制序列。

它的神奇之处在于：

- **看上去像真随机数**（也就是“伪随机”）
    
- **周期最长（2ⁿ - 1）**
    
- **结构明确、可预测**（给足状态就能推出所有未来）
    
- **统计特性良好**（像“假的完美硬币”）
    

---

## 二、形式定义：什么是 m 序列？

---

### 📘 定义（基于 LFSR）：

一个长度为 n 的线性反馈移位寄存器，如果它使用一个 **本原多项式**（primitive polynomial）作为连接多项式，并且初始状态不为全 0，那么它会生成一个周期为：

> `T = 2ⁿ - 1`

的**输出序列**，这个序列就叫做一个 **m 序列（maximum-length sequence）**

---

## 三、m 序列的基本性质

---

### ✅ **性质 1：周期最大**

> m 序列的周期是 `T = 2ⁿ - 1`，这是 n 位 LFSR 能达到的**最大可能周期**

⚠️ 注意：LFSR 的状态数总共是 `2ⁿ`，但不能有全 0 状态（会陷入全 0死循环），所以最多只能遍历 `2ⁿ - 1` 个状态。

---

### ✅ **性质 2：一次周期内 1 和 0 的分布**

> 在一个周期内：

- 1 的个数：`2ⁿ⁻¹`
    
- 0 的个数：`2ⁿ⁻¹ - 1`
    

也就是说：

> m 序列中 1 和 0 的数量非常接近，看起来就像“掷硬币”

---

### ✅ **性质 3：任意 k-bit 模板统计均衡（k ≤ n）**

对任意长度 ≤ n 的“比特窗口”（连续片段），m 序列都满足**统计平衡**：

> 每个非全 0 的 k 位模式都会出现 **恰好一次**，周期内

例如：一个 n = 3 的 m 序列周期为 7，其中每个非零的 3 位组合（如 001, 010, 100 等）都会出现一次。

这说明：m 序列具有**良好的 k 阶分布性**，这就是“伪随机性”的数学版本。

---

### ✅ **性质 4：自相关函数接近理想值**

设 m 序列为  ${a_₀, a_₁, ..., a_{T-1}}$ (周期为T)，它的**周期自相关函数**为：

$$C(τ) = Σ_{i=0}^{T-1} (–1)^{aᵢ ⊕ a_{i+τ}}$$

那么：

- `C(0) = T`（完全相关）
    
- `C(τ) = –1` 对于所有 0 < τ < T
    

👉 这说明：m 序列和它自己的“错位版本”非常不相似（除了 τ=0），这在流密码中非常重要，因为：

> 自相关低 = 不容易预测下一位

---

## 四、为什么 m 序列看起来“伪随机”？

我们说一个序列“伪随机”，通常是指：

1. **不可预测性**（不能轻易猜出下一位）
    
2. **统计特性接近真正随机序列**（比特分布均匀）
    
3. **良好的自相关性**（像白噪声）
    

m 序列虽然是**完全确定的、线性可预测的**，但它的**统计和结构特性**非常接近随机序列，因此被称为**伪随机序列**。

---

### ✅ 伪随机性 vs 真随机性

|特性|真随机数|m 序列（伪随机）|
|---|---|---|
|可预测性|不可预测|可预测（知道状态）|
|生成方式|硬件噪声|LFSR（代数算法）|
|周期性|无周期|有周期|
|分布均匀性|高|高|
|加密是否推荐使用|否|只用于特定结构|
