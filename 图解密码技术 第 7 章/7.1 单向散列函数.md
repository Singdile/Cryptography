## 定义
单向散列函数（one-way hash function）有一个输入和输出，其中输入称为消息(message)，输出称为散列值(hash value)。用单向散列函数，通过判断散列值是否相同来检查消息的完整性。

---
## 性质
1. 任意长度的信息计算出的散列值长度固定。
2. 能快速计算出散列值
3. 信息不同散列值也不同。
4. 两个不同的信息产生同一个散列值的情况称为碰撞。难以发现碰撞的性质称为抗碰撞性。
	- 弱抗碰撞性
	- 强抗碰撞性
5. 单向性，即无法由散列值反推信息的性质


---
## 应用
1. 检测软件是否被篡改
2. 基于口令的加密
3. 构造信息认证码
4. 数字签名
5. 伪随机生成器
6. 构造一次性口令



---
## 单向散列函数的具体例子

SHA-3（Secure Hash Algorithm-3）是一种作为新标准发布的单向散列函数算法，于2012年确定将 Keccak 算法作为 SHA-3 标准。

Keccak 可以生成任意长度的散列值，为了配合 SHA-2 的散列值长度，规定了 SHA3-224、SHA3-256、SHA3-384、SHA3-512 这 4 种版本。

在输入数据的长度上，SHA3没有限制。

---

### Keccak 的海绵结构
![](../Attachment_box/Pasted%20image%2020250717143618.png)

吸收阶段：
1. 内部状态 b 个比特
2. 输入分割为长度为 r bite 的分组
3. 输入分组与状态b中 r 个比特XOR后，作为 f 的输入
4. 同时将 状态b 中 c = b - r 个比特，作为 f 的输入
5. f 函数改变状态，生成新状态b
每次吸收比特 r

挤出阶段：
1. 将 $f$ 的输出值中的 $r$ 个比特保存输出分组
2. 并将整个输出值 b 再次输入 $f$ 
3. 反复执行，直到获取所需长度的输出数据


### Keccak 的内部状态

![](../Attachment_box/Pasted%20image%2020250717145611.png)

状态 $b = 5\times5\times z$ 


---
### $f$ 函数

包括5个步骤：$\theta 、\rho、\pi、\chi、\tau$      

$\theta$  
![](../Attachment_box/Pasted%20image%2020250718084248.png)


$\rho$ 
![](../Attachment_box/Pasted%20image%2020250718084349.png)

$\pi$ 
![](../Attachment_box/Pasted%20image%2020250718084418.png)



$\chi$ 
![](../Attachment_box/Pasted%20image%2020250718084444.png)


$\tau$ 
![](../Attachment_box/Pasted%20image%2020250718084542.png)



----
## 对单向散列函数的攻击（破解弱对抗性）
### 暴力破解
比如将100万的合同更改为1亿万的合同，通过文件的冗余性，更改文件中看不到无法被人直接察觉的内容（增添空格等），找到具有相同散列值的信息。

给定消息1，找出消息2，消息2的散列值同消息1相同，这叫第二原像攻击。
给定散列值，找出该散列值的任意消息，这叫第一原像攻击。


### 生日攻击（破解强对抗性）
在 N 个人中，找出两个生日相同的概率大于 1/2 ，则 N 至少为多少？

记事件 A = 所有人的生日都不相同

$A = 365 \times 364 \times 363 \times \dots \times(365 - N + 1)$  
$total = 365 \times 365 \times \dots \times 365$ 
$P(A) = A/total$ 

N 至少为 23，任意生日相同的概率想象中的要大，这个现象称为生日悖论。

![](../Attachment_box/Pasted%20image%2020250718092545.png)

任意散列值一致的概率比想象中要高。

![](../Attachment_box/Pasted%20image%2020250718092709.png)
