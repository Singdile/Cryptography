## 一、DES 是什么？为什么它重要？

---

### 简要介绍

- DES：**Data Encryption Standard**

- 使用 **对称密钥**，基于**Feistel 结构**
    
- 每次加密固定长度：64 位明文 → 64 位密文
    
- 使用一个 56 位密钥（加上 8 位校验总共 64 位）
    


---

## 二、DES 总体结构

---

### 输入

- 明文 M：64 位
    
- 密钥 K：64 位（其中 8 位用于奇偶校验 → 有效密钥 56 位）
    

---

### 高层结构

1. **初始置换（IP）**：对明文做一次固定打乱
    
2. **16 轮 Feistel 加密**：
    
    - 每轮将当前 64 位数据分为 L（左 32 位）和 R（右 32 位）
        
    - 使用轮函数 $F$ 和一个子密钥  $K_{i}$
        
3. **交换左右半部分**
    
4. **逆置换（IP⁻¹）**
    



![](../Attachment_box/Pasted%20image%2020250711202903.png)


![](../Attachment_box/Pasted%20image%2020250711202922.png)

---

## 三、Feistel 结构 & 每轮操作详解

---

### ✅ 每轮操作

设  $L_i$ 和  $R_i$  是第 $i$ 轮的左右半块，轮函数 $F$ 接收 32 位输入和 48 位子密钥：

$$L_{i+1}=R_i$$
$$R_{i+1}=Li \oplus F(R_i,K_i)$$

这样的设计让加密函数是**可逆的**，即使 $F$ 本身不可逆！

---

### ✅ F 函数结构图解
#### $R_{i-1} \space扩展$ 
![](../Attachment_box/Pasted%20image%2020250711204608.png)


#### S盒代换/选择
代换表参考书上即可。

![](../Attachment_box/Pasted%20image%2020250711204738.png)


---

## 四、密钥调度（Key Schedule）

---

### ✅ 初始处理：

- 输入的 64 位密钥中，每 8 位的最后一位是校验位 → 只使用 56 位
    

---

### ✅ 子密钥生成：

1. **置换选择 1（PC-1）**：将 64 位密钥打乱并减少为 56 位
    
2. **分成 C₀（左 28 位）和 D₀（右 28 位）**
    
3. 每轮进行左移（按轮数不同，有 1 位或 2 位左移）
    
4. 将 C_i 和 D_i 合并为 56 位
    
5. **置换选择 2（PC-2）**：从中选出 48 位作为第 i 轮子密钥
    

---

### ✅ 共生成 16 个子密钥：`K₁, K₂, ..., K₁₆`

这些密钥控制每一轮轮函数 F 的行为。

---

## 六、DES 的安全性与缺陷

---

### ✅ 优点（当时）：

- 简洁高效，可硬件实现
    
- 有较好的扩散和混淆结构
    
- 有公开评审过程（史无前例）
    

---

### ❌ 缺点：

1. **密钥太短（56 位）**
    
    - 可以被穷举（已在上世纪末被破解）
        
2. **已知 S-box，有可行攻击：**
    
    - **差分密码分析**
        
    - **线性密码分析**
        
3. **不适合加密大数据**
    
    - 必须配合分组模式使用，如 CBC、CTR
        

---
