# 介绍设计分组密码的常用方法

---

> 
> 1. **代换（Substitution）**
>     
> 2. **扩散与混淆（Diffusion & Confusion）**
>     
> 3. **Feistel 密码结构**
>     



---

## 一、代换（Substitution）

---

### ✅ 通俗理解：

**用别的东西替换每个基本单元**，思想同古典密码的替换密码是一致的。只是这里的基本单元是一个组，一般有n比特。再用 n 比特代换。

---

### 📘 严格定义：

> **代换（Substitution）** 是指：
> 
> 对输入中的“局部比特块”或“符号”应用一个**非线性映射函数**，即：
> 
>  $S:\{0,1\}^n→{0,1}^n$
> 
> 满足 S 是双射（可逆），且非线性（防止线性攻击）

在分组密码中，这种映射通常叫做 **S-Box（Substitution Box）**

---

### 🔍 举例：AES 中的 S-box

AES 中每个字节（8 比特）被一个非线性查找表替换：

- 输入：`01100011`（十六进制 `0x63`）
    
- 输出：`10100101`（十六进制 `0xA5`）
    

整个过程构成一个 `8→8` 的双射函数表。

---

## 二、扩散与混淆（Diffusion & Confusion）

这两个概念源自香农（Claude Shannon），是设计密码算法的**两个核心目标**。

---

### ✅ 通俗理解：

#### 扩散（Diffusion）类比：

> 把一滴墨水滴入水中 → 你希望它**扩散得非常均匀**

密码学里也是一样：

> 希望 **明文的每一位变化**，都能对**密文的多位造成影响**

#### 混淆（Confusion）类比：

> 把钥匙设计得很复杂，让人**看不出钥匙和锁之间的规则**

密码学中是：

> **密文和密钥之间的关系越复杂越好，最好是非线性的**

---

### 📘 严格定义：

#### 扩散（Diffusion）：

> 一个密码结构具有扩散性，当：
> 
> **明文的单个位变动，会影响密文中大量比特**

数学上通常通过线性变换（如矩阵乘法）实现，例如 AES 中的 **MixColumns**

#### 混淆（Confusion）：

> 一个密码结构具有混淆性，当：
> 
> **密文与密钥之间的关系尽可能复杂、非线性，难以建模**

常用方式是引入 S-box（非线性映射）、轮密钥加法等。

---

### 🔍 举例：

- AES 的 `ShiftRows + MixColumns` 实现扩散
    
- AES 的 `S-box + 密钥加` 实现混淆
    
- DES 的 `S-box` 实现混淆，`置换` 实现扩散
    

---

## 三、Feistel 密码结构（Feistel Cipher Structure）

---

### ✅ 通俗理解：

Feistel 结构是一种设计“可逆加密函数”的聪明办法：

> **明文分两半** → 只加密其中一半 → 再把加密结果“混进去”另一半  
> 多轮之后 → 得到复杂且可逆的密文

这个设计让你：

- 即使每一轮函数不是可逆的
    
- 整个结构却仍然可逆（能解密）
    

它是 DES、SM4、Blowfish 等密码的基础结构。

---

### 📘 严格定义：

设输入块为 `M = (L₀, R₀)`，每一轮进行如下操作：

$$L_{i+1}=R_i$$
$$R_{i+1}=Li \oplus F(R_i,K_i)$$
其中：

-  $F$ 是轮函数，可以是任意复杂的函数（不要求可逆）
    
- $k_i$ 是第 i 轮的轮密钥
    
- 执行多轮后得到 $(L_n, R_n)$ → 密文
    

**解密时只需反向使用轮密钥，并反向迭代即可**

---

### 🔍 举例：参考书上的流程图
![](../Attachment_box/Pasted%20image%2020250711102644.png)




