
---

## 一、通俗理解：什么是分组密码？

### 🎯 类比：用**锁死的保险箱**一批一批地传东西

想象你要寄一堆重要文件给别人：

- 你把每 16 页文件放进一个保险箱（**分组**）
    
- 每个保险箱的上锁方式都一样（由一个密钥控制）
    
- 收件人用同样的密钥打开箱子取出文件
    

这个“统一对每组内容上锁”的加密方法，就是**分组密码**的核心思想。

---

## 二、分组密码的**形式定义**

---

### 📘 数学模型

一个 **分组密码（block cipher）** 是**一族密钥控制的置换函数集合**：


$$E:K×\{0,1\}^n→\{0,1\}^m$$


其中：

- `K` 是密钥空间（如 128 位）
    
- `n` 是分组长度（如 AES 是 128 位 = 16 字节）
    
- 对每个密钥 `k ∈ K`，加密函数 `E_k(x)` 是一个**可逆的置换**
    

并且存在一个对应的**解密函数**：

$$ D_k(y)=E_k^{−1}(y)$$ 

使得：
$$D_k(E_k(x))=x ，\quad x \in \{0,1\}^n$$

![](../Attachment_box/Pasted%20image%2020250710150229.png)

---

### ✅ 重点：

- 每次加密**固定长度 n 比特**的明文块
    
- 加密结果是**相同长度**的密文块 （但是不一定是和加密前的长度相等的）
    
- 加密函数是**可逆的置换函数**（与对称加密相关）
    
- 加解密依赖于同一个密钥（对称密码）

---
### 一族密钥控制的置换函数集合

####  🎯 类比：不同的“锁”对同一把钥匙有不同反应

想象你有一个保险箱工厂：

- 所有的保险箱都长得一模一样，都是 128 位的（比如 AES 的输入块）
    
- 每一把钥匙 `k`，都对应一整套**开锁规则**
    
- 同一个输入，换一把钥匙，输出就会变
    

所以：

> 每一把密钥都“控制”了一种输入 → 输出的“映射方式”（也就是函数）

而这个映射是：

- 一对一的（可逆）
    
- 定长的（比如 128 位到 128 位）
    
- 密钥不同 → 函数不同
    

这就构成了**一个密钥控制的置换函数集合**。

---

### ✅ 为什么是“**一族**”？

因为 `k` 取不同的值，你就得到不同的函数 `E_k`。所以这不是一个函数，而是一个**函数族（function family）**。

- 如果 $K = \{k_1, k_2, k_3\}$ ，那我们就有：  
    ${E_{k_1}, E_{k_2}, E_{k_3}}$ 这样的函数族
    

在 AES 里，$K = \{0,1\}^ {128}$ ，所以这个函数族有 **2¹²⁸ 个成员**！
在 AES 里，所以这个函数族有 **2¹²⁸ 个成员**！

---

## 三、密码学意义：为什么用置换？

### 🔐 为什么是**置换函数（bijection）**？

因为我们要保证：

> **加密之后可以唯一还原为原文（可逆性）**

如果加密函数不是置换，那就可能出现：

- `E_k(x₁) = E_k(x₂)`（不可逆，信息丢失）
    
- 或者 `E_k(x)` 没有定义（不完整）
    

在密码学中，这是绝对不能容忍的：**加密必须可逆、无损、完整**

---
###  ✅ 总结一句话

> “一族密钥控制的置换函数集合”就是：
> 
> 一个由**密钥空间 K**控制的函数族，每个函数 `E_k` 都是把 n 位明文映射到 n 位密文的一一对应函数（置换），满足加解密互为逆操作。


---

## 三、分组密码 vs 流密码

|比较项|分组密码|流密码|
|---|---|---|
|加密单位|一整个“分组块”（如128位）|一个位或字节|
|加密方式|每块固定变换|逐位与密钥流异或|
|常见算法|AES、DES、IDEA、SM4|RC4、ChaCha20、Grain|
|安全核心|块置换 + 混淆扩散结构（如S盒P盒）|密钥流生成器的伪随机性|
|应用场景|数据加密、大文件、数据库、TLS等|语音/视频流加密、无线通信等|
|构建模式|需要“分组模式”（如CBC、CTR）|直接异或即可|

---

## 四、为什么需要“分组”？

因为我们无法直接设计一个对任意长度信息加密的函数：

- 流密码：必须生成**足够长的密钥流**
    
- 分组密码：每次只能处理 **n 比特**（如 128 位）
    

所以：

- 明文长 → 分成一组一组（称为“分组”）
    
- 每一组单独加密，再拼起来
    

---

## 五、分组密码的安全核心：**每个密钥对应一个置换**

在**理想情况**下：

> 对一个 n 比特的输入，分组密码应该在所有 `2ⁿ!` 个可能的置换中“等概率”选择一个

当然这是做不到的，所以我们设计分组密码的目标是：**尽可能像随机置换**。

这就引出了后面你会学到的：

- **S-Box**（非线性替换）
    
- **P-Box**（扩散/置换结构）
    
- **Feistel结构**（如 DES）
    
- **SubBytes/MixColumns**（如 AES）
    

---

## 六、分组密码的实际加密：需要“分组模式”

因为分组密码只能处理固定长度的块，我们需要**特殊机制**来处理**可变长度的消息**，这就叫做：

> **分组密码的工作模式（Block Cipher Modes of Operation）**

包括：

|模式|特点|
|---|---|
|ECB|直接分组独立加密，**不安全**|
|CBC|每块与前一块密文异或（链式加密）|
|CFB|像流密码一样工作（加密反馈）|
|OFB|输出反馈，完全变成流密码|
|CTR|计数器模式，**并行友好**，高效|

---

## ✅ 小结：分组密码是现代加密的骨干

|概念|理解方式|
|---|---|
|分组密码定义|对固定长度 bit 块进行**密钥控制置换**|
|密钥|控制每个置换的唯一身份|
|安全目标|像“伪随机置换”，满足机密性和不可预测性|
|实际使用|需要“分组模式”来处理长消息|

---

