## 一、单表代换密码（Monoalphabetic Substitution）

### 📌 直观理解

想象我们有一个26个字母的英语字母表：

```
原字母: A B C D E F G H I J K L M N O P Q R S T U V W X Y Z
密字母: Q W E R T Y U I O P A S D F G H J K L Z X C V B N M
```

你写一封信，用上面的“密字母”表一一代替原文中每个字母。比如：

```
明文：HELLO
密文：ITSSG
```

**只用了一个“替换表”来替换所有字母，所以叫做“**单表代换**”。

---

### 📘 严格定义

**单表代换密码**是定义在有限明文字母表 Σ 上的一个函数加密系统：

> 对于字母表 Σ（如 A-Z），一个单表代换就是一个**双射（bijection）**：  
> 使得每个明文字母 m ∈ Σ 映射为密文字母 c = π(m)


加密函数：

> `E(k, m₁m₂...mₙ) = π(m₁)π(m₂)...π(mₙ)`  
> 其中密钥 k 是这张“替换表”π（即对字母表 Σ 的一个排列）

解密函数：

> `D(k, c₁c₂...cₙ) = π⁻¹(c₁)π⁻¹(c₂)...π⁻¹(cₙ)`

---

### 🔓 安全性分析

- **密钥空间大小**：26个字母全排列，所以密钥总数是 `26! ≈ 2^88`，看起来很多
    
- **弱点**：统计特征暴露！比如在英文中字母 **E** 出现频率最高，如果在密文中 **X** 出现最多，攻击者就会怀疑 X 是 E。
    

🔍 所以，它很容易被**频率分析法（frequency analysis）**破解。

---

## 二、多表代换密码（Polyalphabetic Substitution）

### 📌 通俗理解

为了打败频率分析，人们引入了“多表代换”：

- 不止用一张替换表，而是**交替使用多张替换表**
    
- 哪张表用在哪个字母上，是由“密钥”控制的
    

最著名的例子是：**维吉尼亚密码（Vigenère Cipher）**

---

### 📝 Vigenère 密码（多表代换代表）

你有一条明文：

```
明文：ATTACKATDAWN
密钥：LEMONLEMONLE
```

每个明文字母的位置，配一个密钥字母：

- 明文A（0）配L（11） → A+L = L
    
- 明文T（19）配E（4） → T+E = X
    
- 明文T（19）配M（12） → T+M = F
    

依此类推：明文中的每个字母，被对应的“字母移位规则”加密。

这里可以理解为：密钥中每个位置上的“字母”代表了一个单表替换的表，所以这里就组成了多表替换。

---

### 📘 严格定义

给定：

- 明文字母表 Σ（如 A-Z，共26个字母，编号 0~25）
    
- 一个密钥串 `k = k₁k₂...k_t ∈ Σ^t`，t是密钥长度
    
- 加密函数如下：
    

> 对每个明文字母 mᵢ ∈ Σ，在位置 i，取密钥字母 kⱼ（j = i mod t），然后：

> `cᵢ = (mᵢ + kⱼ) mod 26`

解密函数是：

> `mᵢ = (cᵢ - kⱼ + 26) mod 26`

这其实是用不同的**Caesar移位密码**交替加密每个字母。

---

### 🔓 安全性分析

- **比单表代换更强**：因为不同位置用不同的加密函数，频率被打乱
    
- **仍可被破解**：如果攻击者能猜到密钥长度 `t`，就可以把密文分成 t 个子序列，各自用频率分析破解（卡西斯基检验）
    

---
